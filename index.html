<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>–° –î–Ω–µ–º –†–æ–∂–¥–µ–Ω–∏—è, –ù–∞—Ä–∏–º–∞–Ω! 23 –≥–æ–¥–∞!</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            touch-action: manipulation;
        }
        
        body {
            font-family: 'Nunito', sans-serif;
            overflow: hidden;
            background: linear-gradient(180deg, #87CEEB 0%, #E0F6FF 100%);
            height: 100vh;
            height: 100dvh;
        }
        
        .title-text {
            font-family: 'Fredoka One', cursive;
            text-shadow: 3px 3px 0 #FF6B9D, 6px 6px 0 rgba(0,0,0,0.1);
        }
        
        .cartoon-btn {
            font-family: 'Fredoka One', cursive;
            background: linear-gradient(180deg, #FF6B9D 0%, #FF4777 100%);
            border: 4px solid #CC3366;
            border-radius: 50px;
            box-shadow: 0 6px 0 #CC3366, 0 10px 20px rgba(0,0,0,0.2);
            transition: all 0.1s;
        }
        
        .cartoon-btn:active {
            transform: translateY(4px);
            box-shadow: 0 2px 0 #CC3366, 0 4px 10px rgba(0,0,0,0.2);
        }
        
        /* –¢–æ—Ä—Ç */
        .cake {
            position: relative;
            width: 120px;
            height: 190px;
        }
        
        .cake-layer {
            position: absolute;
            border-radius: 10px;
            box-shadow: inset 0 -10px 20px rgba(0,0,0,0.1);
        }
        
        .cake-bottom {
            bottom: 0;
            left: 0;
            width: 120px;
            height: 45px;
            background: linear-gradient(180deg, #FFB6C1 0%, #FF69B4 100%);
            border: 3px solid #FF1493;
        }
        
        .cake-middle {
            bottom: 40px;
            left: 15px;
            width: 90px;
            height: 35px;
            background: linear-gradient(180deg, #DDA0DD 0%, #BA55D3 100%);
            border: 3px solid #9932CC;
        }
        
        .cake-top {
            bottom: 70px;
            left: 30px;
            width: 60px;
            height: 30px;
            background: linear-gradient(180deg, #87CEEB 0%, #4169E1 100%);
            border: 3px solid #1E90FF;
        }
        
        /* –°–≤–µ—á–∫–∞ */
        .candle {
            position: absolute;
            bottom: 95px;
            left: 50%;
            transform: translateX(-50%);
            width: 12px;
            height: 30px;
            background: linear-gradient(90deg, #FFFF00 0%, #FFD700 50%, #FFFF00 100%);
            border-radius: 3px;
            border: 2px solid #FFA500;
        }
        
        .flame {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 14px;
            height: 20px;
            background: radial-gradient(ellipse at bottom, #FFFF00 0%, #FF6600 50%, #FF0000 100%);
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            animation: flicker 0.3s infinite alternate;
        }
        
        @keyframes flicker {
            0% { transform: translateX(-50%) scale(1) rotate(-3deg); }
            100% { transform: translateX(-50%) scale(1.1) rotate(3deg); }
        }
        
        /* –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ */
        #gameCanvas {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        
        /* –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            animation: confetti-fall 3s linear infinite;
        }
        
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }
        
        /* HUD */
        .game-hud {
            position: absolute;
            top: 10px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: space-between;
            padding: 10px 20px;
            z-index: 100;
        }
        
        .score-box, .pause-btn {
            background: linear-gradient(180deg, #FFE135 0%, #FFD700 100%);
            border: 3px solid #CC9900;
            border-radius: 15px;
            padding: 8px 16px;
            font-family: 'Fredoka One', cursive;
            font-size: 18px;
            color: #663300;
            box-shadow: 0 4px 0 #CC9900;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ */
        .modal {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(180deg, #FFF5EE 0%, #FFE4E1 100%);
            border: 5px solid #FF69B4;
            border-radius: 30px;
            padding: 30px;
            text-align: center;
            z-index: 200;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        
        .overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 150;
        }
    </style>
</head>
<body>
    <!-- –ù–∞—á–∞–ª—å–Ω—ã–π —ç–∫—Ä–∞–Ω -->
    <div id="startScreen" class="flex flex-col items-center justify-center h-full relative">
        <!-- –ö–æ–Ω—Ñ–µ—Ç—Ç–∏ -->
        <div id="confettiContainer"></div>
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–∫–∏ -->
        <h1 class="title-text text-3xl sm:text-5xl text-pink-500 mb-2 text-center px-4">
            –° –î–Ω–µ–º –†–æ–∂–¥–µ–Ω–∏—è, –ù–∞—Ä–∏–º–∞–Ω! üéÇ
        </h1>
        <h2 class="title-text text-4xl sm:text-6xl text-purple-500 mb-8">
            23 –≥–æ–¥–∞! üéâ
        </h2>
        
        <!-- –¢–æ—Ä—Ç -->
        <div class="cake mb-10" id="mainCake">
            <div class="cake-layer cake-bottom"></div>
            <div class="cake-layer cake-middle"></div>
            <div class="cake-layer cake-top"></div>
            <div class="candle">
                <div class="flame"></div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∞ —Å—Ç–∞—Ä—Ç–∞ -->
        <button id="startBtn" class="cartoon-btn text-white text-xl sm:text-2xl px-8 py-4">
            üéà –ù–∞—á–∞—Ç—å –ø—Ä–∞–∑–¥–Ω–æ–≤–∞—Ç—å! üéà
        </button>
    </div>
    
    <!-- –ò–≥—Ä–æ–≤–æ–π —ç–∫—Ä–∞–Ω -->
    <div id="gameScreen" class="hidden h-full relative">
        <canvas id="gameCanvas"></canvas>
        
        <!-- HUD -->
        <div class="game-hud" id="gameHud">
            <div class="score-box">üéÇ <span id="scoreDisplay">0</span></div>
            <button class="pause-btn" id="pauseBtn">‚è∏Ô∏è</button>
        </div>
    </div>
    
    <!-- –ü–∞—É–∑–∞ -->
    <div id="pauseOverlay" class="overlay hidden"></div>
    <div id="pauseModal" class="modal hidden">
        <h2 class="title-text text-3xl text-purple-500 mb-6">‚è∏Ô∏è –ü–∞—É–∑–∞</h2>
        <button id="resumeBtn" class="cartoon-btn text-white text-xl px-6 py-3 mb-3 block w-full">
            ‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å
        </button>
        <button id="restartFromPauseBtn" class="cartoon-btn text-white text-xl px-6 py-3 block w-full">
            üîÑ –ó–∞–Ω–æ–≤–æ
        </button>
    </div>
    
    <!-- –ü—Ä–æ–∏–≥—Ä—ã—à -->
    <div id="gameOverOverlay" class="overlay hidden"></div>
    <div id="gameOverModal" class="modal hidden">
        <h2 class="title-text text-3xl text-pink-500 mb-2">üéÇ –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞!</h2>
        <p class="text-2xl text-purple-600 mb-2">–¢–≤–æ–π —Å—á—ë—Ç:</p>
        <p class="title-text text-5xl text-yellow-500 mb-6" id="finalScore">0</p>
        <button id="restartBtn" class="cartoon-btn text-white text-xl px-8 py-4">
            üéà –ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞! üéà
        </button>
    </div>

    <script>
        // –≠–ª–µ–º–µ–Ω—Ç—ã
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resumeBtn = document.getElementById('resumeBtn');
        const restartBtn = document.getElementById('restartBtn');
        const restartFromPauseBtn = document.getElementById('restartFromPauseBtn');
        const pauseOverlay = document.getElementById('pauseOverlay');
        const pauseModal = document.getElementById('pauseModal');
        const gameOverOverlay = document.getElementById('gameOverOverlay');
        const gameOverModal = document.getElementById('gameOverModal');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const finalScore = document.getElementById('finalScore');
        const confettiContainer = document.getElementById('confettiContainer');
        
        // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let gameRunning = false;
        let gamePaused = false;
        let score = 0;
        let speed = 5;
        let lanes = [0, 1, 2]; // 3 –¥–æ—Ä–æ–∂–∫–∏
        let currentLane = 1;
        let targetLane = 1;
        let obstacles = [];
        let collectibles = [];
        let lastObstacleTime = 0;
        let animationId;
        
        // –ò–≥—Ä–æ–∫ (—Ç–æ—Ä—Ç)
        let player = {
            x: 0,
            y: 0,
            width: 60,
            height: 50,
            laneX: 0
        };
        
        // –†–∞–∑–º–µ—Ä—ã
        let laneWidth;
        let roadLeft;
        let roadWidth;
        
        // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ñ–µ—Ç—Ç–∏ –Ω–∞ –Ω–∞—á–∞–ª—å–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
        function createConfetti() {
            const colors = ['#FF6B9D', '#FFD700', '#87CEEB', '#98FB98', '#DDA0DD', '#FF6347'];
            for (let i = 0; i < 30; i++) {
                const confetti = document.createElement('div');
                confetti.className = 'confetti';
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
                confetti.style.animationDelay = Math.random() * 3 + 's';
                confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
                confettiContainer.appendChild(confetti);
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è canvas
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            roadWidth = Math.min(canvas.width * 0.9, 350);
            roadLeft = (canvas.width - roadWidth) / 2;
            laneWidth = roadWidth / 3;
            
            player.y = canvas.height - 120;
            updatePlayerPosition();
        }
        
        function updatePlayerPosition() {
            player.laneX = roadLeft + laneWidth * currentLane + laneWidth / 2 - player.width / 2;
            player.x += (player.laneX - player.x) * 0.2;
        }
        
        // –†–∏—Å–æ–≤–∞–Ω–∏–µ
        function drawRoad() {
            // –ù–µ–±–æ
            const skyGradient = ctx.createLinearGradient(0, 0, 0, canvas.height);
            skyGradient.addColorStop(0, '#87CEEB');
            skyGradient.addColorStop(1, '#E0F6FF');
            ctx.fillStyle = skyGradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // –¢—Ä–∞–≤–∞ –ø–æ –±–æ–∫–∞–º
            ctx.fillStyle = '#7CFC00';
            ctx.fillRect(0, 0, roadLeft, canvas.height);
            ctx.fillRect(roadLeft + roadWidth, 0, canvas.width - roadLeft - roadWidth, canvas.height);
            
            // –î–æ—Ä–æ–≥–∞
            const roadGradient = ctx.createLinearGradient(roadLeft, 0, roadLeft + roadWidth, 0);
            roadGradient.addColorStop(0, '#888');
            roadGradient.addColorStop(0.5, '#AAA');
            roadGradient.addColorStop(1, '#888');
            ctx.fillStyle = roadGradient;
            ctx.fillRect(roadLeft, 0, roadWidth, canvas.height);
            
            // –ë–æ—Ä–¥—é—Ä—ã
            ctx.fillStyle = '#FF6347';
            ctx.fillRect(roadLeft - 10, 0, 10, canvas.height);
            ctx.fillRect(roadLeft + roadWidth, 0, 10, canvas.height);
            
            // –ü–æ–ª–æ—Å—ã –Ω–∞ –±–æ—Ä–¥—é—Ä–∞—Ö
            ctx.fillStyle = '#FFD700';
            for (let y = (Date.now() / 50) % 40; y < canvas.height; y += 40) {
                ctx.fillRect(roadLeft - 10, y, 10, 20);
                ctx.fillRect(roadLeft + roadWidth, y, 10, 20);
            }
            
            // –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å–Ω—ã–µ –ª–∏–Ω–∏–∏
            ctx.strokeStyle = '#FFF';
            ctx.lineWidth = 4;
            ctx.setLineDash([30, 20]);
            ctx.lineDashOffset = -(Date.now() / 20) % 50;
            
            for (let i = 1; i < 3; i++) {
                ctx.beginPath();
                ctx.moveTo(roadLeft + laneWidth * i, 0);
                ctx.lineTo(roadLeft + laneWidth * i, canvas.height);
                ctx.stroke();
            }
            ctx.setLineDash([]);
        }
        
        function drawCake(x, y, scale = 1) {
            const w = 60 * scale;
            const h = 50 * scale;
            
            // –ù–∏–∂–Ω–∏–π —Å–ª–æ–π (—Ä–æ–∑–æ–≤—ã–π)
            ctx.fillStyle = '#FF69B4';
            ctx.strokeStyle = '#FF1493';
            ctx.lineWidth = 2;
            roundRect(ctx, x - w/2, y - h * 0.4, w, h * 0.4, 5);
            
            // –°—Ä–µ–¥–Ω–∏–π —Å–ª–æ–π (—Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π)
            ctx.fillStyle = '#BA55D3';
            ctx.strokeStyle = '#9932CC';
            roundRect(ctx, x - w * 0.4, y - h * 0.7, w * 0.8, h * 0.35, 5);
            
            // –í–µ—Ä—Ö–Ω–∏–π —Å–ª–æ–π (–≥–æ–ª—É–±–æ–π)
            ctx.fillStyle = '#4169E1';
            ctx.strokeStyle = '#1E90FF';
            roundRect(ctx, x - w * 0.3, y - h, w * 0.6, h * 0.3, 5);
            
            // –°–≤–µ—á–∫–∞
            ctx.fillStyle = '#FFD700';
            ctx.fillRect(x - 4, y - h - 15, 8, 18);
            
            // –ü–ª–∞–º—è
            ctx.fillStyle = '#FF6600';
            ctx.beginPath();
            ctx.ellipse(x, y - h - 22, 6, 10, 0, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#FFFF00';
            ctx.beginPath();
            ctx.ellipse(x, y - h - 20, 3, 6, 0, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function roundRect(ctx, x, y, w, h, r) {
            ctx.beginPath();
            ctx.moveTo(x + r, y);
            ctx.lineTo(x + w - r, y);
            ctx.quadraticCurveTo(x + w, y, x + w, y + r);
            ctx.lineTo(x + w, y + h - r);
            ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
            ctx.lineTo(x + r, y + h);
            ctx.quadraticCurveTo(x, y + h, x, y + h - r);
            ctx.lineTo(x, y + r);
            ctx.quadraticCurveTo(x, y, x + r, y);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
        }
        
        function drawObstacle(obs) {
            const x = roadLeft + laneWidth * obs.lane + laneWidth / 2;
            const y = obs.y;
            
            if (obs.type === 'balloon') {
                // –í–æ–∑–¥—É—à–Ω—ã–π —à–∞—Ä–∏–∫ (–ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ)
                ctx.fillStyle = obs.color;
                ctx.beginPath();
                ctx.ellipse(x, y, 25, 30, 0, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                // –ë–ª–∏–∫
                ctx.fillStyle = 'rgba(255,255,255,0.4)';
                ctx.beginPath();
                ctx.ellipse(x - 8, y - 10, 6, 10, -0.5, 0, Math.PI * 2);
                ctx.fill();
                
                // –ù–∏—Ç–æ—á–∫–∞
                ctx.strokeStyle = '#666';
                ctx.beginPath();
                ctx.moveTo(x, y + 30);
                ctx.quadraticCurveTo(x + 5, y + 45, x, y + 55);
                ctx.stroke();
            } else if (obs.type === 'gift') {
                // –ü–æ–¥–∞—Ä–æ–∫ (–ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–µ)
                ctx.fillStyle = obs.color;
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                roundRect(ctx, x - 25, y - 20, 50, 40, 5);
                
                // –õ–µ–Ω—Ç–∞
                ctx.fillStyle = '#FFD700';
                ctx.fillRect(x - 5, y - 20, 10, 40);
                ctx.fillRect(x - 25, y - 5, 50, 10);
                
                // –ë–∞–Ω—Ç–∏–∫
                ctx.fillStyle = '#FFD700';
                ctx.beginPath();
                ctx.ellipse(x - 12, y - 25, 10, 8, -0.3, 0, Math.PI * 2);
                ctx.fill();
                ctx.beginPath();
                ctx.ellipse(x + 12, y - 25, 10, 8, 0.3, 0, Math.PI * 2);
                ctx.fill();
            }
        }
        
        function drawCollectible(col) {
            const x = roadLeft + laneWidth * col.lane + laneWidth / 2;
            const y = col.y;
            
            // –ó–≤–µ–∑–¥–æ—á–∫–∞
            ctx.fillStyle = '#FFD700';
            ctx.strokeStyle = '#FFA500';
            ctx.lineWidth = 2;
            drawStar(x, y, 5, 20, 10);
            
            // –ë–ª–∏–∫
            ctx.fillStyle = '#FFFACD';
            ctx.beginPath();
            ctx.arc(x - 5, y - 5, 5, 0, Math.PI * 2);
            ctx.fill();
        }
        
        function drawStar(cx, cy, spikes, outerRadius, innerRadius) {
            let rot = Math.PI / 2 * 3;
            let x = cx;
            let y = cy;
            const step = Math.PI / spikes;
            
            ctx.beginPath();
            ctx.moveTo(cx, cy - outerRadius);
            
            for (let i = 0; i < spikes; i++) {
                x = cx + Math.cos(rot) * outerRadius;
                y = cy + Math.sin(rot) * outerRadius;
                ctx.lineTo(x, y);
                rot += step;
                
                x = cx + Math.cos(rot) * innerRadius;
                y = cy + Math.sin(rot) * innerRadius;
                ctx.lineTo(x, y);
                rot += step;
            }
            
            ctx.lineTo(cx, cy - outerRadius);
            ctx.closePath();
            ctx.fill();
            ctx.stroke();
        }
        
        // –°–ø–∞–≤–Ω –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
        function spawnObstacle() {
            const types = ['balloon', 'gift'];
            const colors = ['#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7', '#DDA0DD'];
            
            const obstacle = {
                type: types[Math.floor(Math.random() * types.length)],
                lane: Math.floor(Math.random() * 3),
                y: -50,
                color: colors[Math.floor(Math.random() * colors.length)]
            };
            
            obstacles.push(obstacle);
            
            // –ò–Ω–æ–≥–¥–∞ –¥–æ–±–∞–≤–ª—è–µ–º –∑–≤–µ–∑–¥–æ—á–∫—É
            if (Math.random() > 0.6) {
                let starLane;
                do {
                    starLane = Math.floor(Math.random() * 3);
                } while (starLane === obstacle.lane);
                
                collectibles.push({
                    lane: starLane,
                    y: -50
                });
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
        function checkCollisions() {
            const playerCenterX = player.x + player.width / 2;
            const playerTop = player.y - player.height;
            
            // –ü—Ä–µ–ø—è—Ç—Å—Ç–≤–∏—è
            for (let i = obstacles.length - 1; i >= 0; i--) {
                const obs = obstacles[i];
                const obsX = roadLeft + laneWidth * obs.lane + laneWidth / 2;
                
                if (Math.abs(playerCenterX - obsX) < 35 && 
                    obs.y > playerTop - 30 && obs.y < player.y + 20) {
                    gameOver();
                    return;
                }
            }
            
            // –ó–≤–µ–∑–¥–æ—á–∫–∏
            for (let i = collectibles.length - 1; i >= 0; i--) {
                const col = collectibles[i];
                const colX = roadLeft + laneWidth * col.lane + laneWidth / 2;
                
                if (Math.abs(playerCenterX - colX) < 40 && 
                    col.y > playerTop - 20 && col.y < player.y + 10) {
                    score += 10;
                    scoreDisplay.textContent = score;
                    collectibles.splice(i, 1);
                }
            }
        }
        
        // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
        function gameLoop() {
            if (!gameRunning || gamePaused) return;
            
            // –ü–ª–∞–≤–Ω–æ–µ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –∫ —Ü–µ–ª–∏
            currentLane += (targetLane - currentLane) * 0.15;
            updatePlayerPosition();
            
            // –î–≤–∏–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
            obstacles.forEach(obs => obs.y += speed);
            collectibles.forEach(col => col.y += speed);
            
            // –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã—à–µ–¥—à–∏—Ö –∑–∞ —ç–∫—Ä–∞–Ω
            obstacles = obstacles.filter(obs => obs.y < canvas.height + 100);
            collectibles = collectibles.filter(col => col.y < canvas.height + 100);
            
            // –°–ø–∞–≤–Ω –Ω–æ–≤—ã—Ö –ø—Ä–µ–ø—è—Ç—Å—Ç–≤–∏–π
            if (Date.now() - lastObstacleTime > 1200 - Math.min(score, 500)) {
                spawnObstacle();
                lastObstacleTime = Date.now();
            }
            
            // –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
            speed = 5 + Math.floor(score / 50) * 0.5;
            score += 0.1;
            scoreDisplay.textContent = Math.floor(score);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
            checkCollisions();
            
            // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
            drawRoad();
            
            obstacles.forEach(obs => drawObstacle(obs));
            collectibles.forEach(col => drawCollectible(col));
            
            drawCake(player.x + player.width / 2, player.y);
            
            animationId = requestAnimationFrame(gameLoop);
        }
        
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        function handleInput(direction) {
            if (!gameRunning || gamePaused) return;
            
            if (direction === 'left' && targetLane > 0) {
                targetLane--;
            } else if (direction === 'right' && targetLane < 2) {
                targetLane++;
            }
        }
        
        // –°–≤–∞–π–ø—ã
        let touchStartX = 0;
        let touchStartY = 0;
        
        canvas.addEventListener('touchstart', (e) => {
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
        });
        
        canvas.addEventListener('touchend', (e) => {
            const touchEndX = e.changedTouches[0].clientX;
            const touchEndY = e.changedTouches[0].clientY;
            const diffX = touchEndX - touchStartX;
            const diffY = touchEndY - touchStartY;
            
            if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 30) {
                handleInput(diffX > 0 ? 'right' : 'left');
            }
        });
        
        // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞
        document.addEventListener('keydown', (e) => {
            if (e.key === 'ArrowLeft' || e.key === 'a') handleInput('left');
            if (e.key === 'ArrowRight' || e.key === 'd') handleInput('right');
            if (e.key === 'Escape' || e.key === 'p') togglePause();
        });
        
        // –ö–ª–∏–∫–∏ –ø–æ –ø–æ–ª–æ–≤–∏–Ω–∞–º —ç–∫—Ä–∞–Ω–∞
        canvas.addEventListener('click', (e) => {
            const x = e.clientX;
            if (x < canvas.width / 2) {
                handleInput('left');
            } else {
                handleInput('right');
            }
        });
        
        // –§—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã
        function startGame() {
            startScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            canvas.style.display = 'block';
            
            resizeCanvas();
            resetGame();
            
            gameRunning = true;
            gamePaused = false;
            lastObstacleTime = Date.now();
            
            gameLoop();
        }
        
        function resetGame() {
            score = 0;
            speed = 5;
            obstacles = [];
            collectibles = [];
            currentLane = 1;
            targetLane = 1;
            scoreDisplay.textContent = '0';
            updatePlayerPosition();
            player.x = player.laneX;
        }
        
        function togglePause() {
            if (!gameRunning) return;
            
            gamePaused = !gamePaused;
            pauseOverlay.classList.toggle('hidden', !gamePaused);
            pauseModal.classList.toggle('hidden', !gamePaused);
            
            if (!gamePaused) {
                gameLoop();
            }
        }
        
        function gameOver() {
            gameRunning = false;
            cancelAnimationFrame(animationId);
            
            finalScore.textContent = Math.floor(score);
            gameOverOverlay.classList.remove('hidden');
            gameOverModal.classList.remove('hidden');
        }
        
        function restartGame() {
            gameOverOverlay.classList.add('hidden');
            gameOverModal.classList.add('hidden');
            pauseOverlay.classList.add('hidden');
            pauseModal.classList.add('hidden');
            
            resetGame();
            gameRunning = true;
            gamePaused = false;
            lastObstacleTime = Date.now();
            gameLoop();
        }
        
        // –°–æ–±—ã—Ç–∏—è
        startBtn.addEventListener('click', startGame);
        pauseBtn.addEventListener('click', togglePause);
        resumeBtn.addEventListener('click', togglePause);
        restartBtn.addEventListener('click', restartGame);
        restartFromPauseBtn.addEventListener('click', restartGame);
        
        window.addEventListener('resize', () => {
            if (gameRunning) resizeCanvas();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        createConfetti();
    </script>
</body>
</html>
